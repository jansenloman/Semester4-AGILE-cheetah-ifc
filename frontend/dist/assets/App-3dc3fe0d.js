import{a as z,_ as B,b as F}from"./SearchBar.vue_vue_type_style_index_0_lang-265b0b09.js";import{b as J,M as I}from"./classes-929a4aba.js";import{d as y,l as M,G as q,K as O,A as N,i as v,P as A,D as U,L as k,q as j,o,b as d,n as t,F as C,y as V,c as h,u as s,v as D,x as f,z as K,N as E,t as x,a as p,p as Y,s as G,w as T,T as W,S as H,H as R,M as Q,J as X}from"./index-a9e6055c.js";import{s as S}from"./requests-8927b21a.js";import{_ as Z}from"./OrderListItem.vue_vue_type_script_setup_true_lang-8ae4ca92.js";import{_ as L}from"./IconButton.vue_vue_type_style_index_0_lang-60770588.js";import{_ as ee}from"./Pagination.vue_vue_type_script_setup_true_lang-b254a2b2.js";import{a as te,S as se,_ as ne}from"./MenuCard.vue_vue_type_style_index_0_lang-48430eae.js";import{_ as ae}from"./MaybeImage.vue_vue_type_script_setup_true_lang-2985bd86.js";import"./FetchWrapper.vue_vue_type_script_setup_true_lang-39891d1c.js";import"./RadioInput.vue_vue_type_script_setup_true_lang-8f6d06c1.js";import"./inputs-cac6fc85.js";const oe=y({__name:"OrdersProvider",setup(i){const e=M({current:null,orders:[],viewedOrder:void 0,add:c,remove:l,examine:m,createTransaction:_,finishTransaction:w,cancelTransaction:b}),n=q(!0),a=v(A);function c(r){let g=e.orders.find($=>$.id==r.id);g?g.quantity++:e.orders.push(new J(r))}function l(r){let g=e.orders.indexOf(r);g!=-1&&e.orders.splice(g,1)}function m(r){e.viewedOrder=r}async function _(){e.viewedOrder=void 0,a.run(async()=>{const r=await fetch(N+"/orders",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e.orders.map($=>({name:$.name,price:$.price,quantity:$.quantity,note:$.note})))});if(!r.ok)throw r;const g=await r.json();e.current=I.fromJSON(g),e.orders=[]})}async function w(){e.current=null}async function b(){e.current&&(e.orders=e.current.orders,e.current=null)}async function u(){const r=await fetch(N+"/orders/ongoing",{credentials:"include"});if(!r.ok)return;const g=await r.json();e.current=I.fromJSON(g),n.value=!1}return U(k,e),u(),(r,g)=>O(r.$slots,"default")}}),re="/assets/schedule-2f1cd04c.svg",ie="/assets/check-a40930ed.svg",ce="/assets/cancel-58c7ea43.svg",le={class:"d-flex mt-5 mx-2 mx-lg-5"},de={class:"col-6 tss-bg-secondary-dark position-relative rounded"},ue=t("header",{class:"tss-bg-primary px-3 py-2 text-center fs-2 fw-bold rounded"}," Pesanan Anda ",-1),me={class:"py-4 px-3"},_e={class:"list-group transaction-summary-list"},fe=t("hr",null,null,-1),pe={class:"position-absolute bottom-0 mb-3"},ve=t("b",null,"Total: ",-1),he={class:"col-6 d-flex flex-column align-items-center darkened-bg p-3"},ge={key:0},ye={key:1},be=t("p",{class:"text-danger"},"Pesan anda telah dibatalkan karena:",-1),we={class:"alert alert-danger"},ke={key:2,id:"waiting-logo",class:"status-logo mt-3"},Oe=t("img",{src:re,alt:"Waiting..."},null,-1),$e=[Oe],xe={key:3,id:"success-logo",class:"status-logo mt-3"},Ce={key:4,id:"cancel-logo",class:"status-logo mt-3"},Te=y({__name:"WaitView",setup(i){const e=v(k),n={cancelReason:""};return S.on("cookOrder",a=>{a==e.current.id&&(e.current.phase="cooking")}),S.on("finishOrder",a=>{a==e.current.id&&(e.current.phase="finished")}),S.on("cancelOrder",(a,c)=>{a==e.current.id&&(e.current.phase="canceled",n.cancelReason=c)}),j(()=>{S.off("cookOrder"),S.off("finishOrder")}),(a,c)=>(o(),d("div",le,[t("div",de,[ue,t("div",me,[t("ul",_e,[(o(!0),d(C,null,V(s(e).current.orders,l=>(o(),h(Z,{item:l},null,8,["item"]))),256))]),fe,t("div",pe,[ve,D(" "+f(s(e).current.hargaTotal),1)])])]),t("div",he,[t("div",{class:K(["text-capitalize fs-2 p-3 rounded fw-bold",{"text-warning":s(e).current.phase=="pending","text-info":s(e).current.phase=="cooking","text-success":s(e).current.phase=="finished","text-danger":s(e).current.phase=="canceled","fw-bold":s(e).current.phase=="finished"}])},f(s(e).current.phase),3),s(e).current.phase=="finished"?(o(),d("div",ge,[t("a",{class:"text-success fw-bold",href:"#",onClick:c[0]||(c[0]=E((...l)=>s(e).finishTransaction&&s(e).finishTransaction(...l),["prevent"]))}," Click untuk kembali ke halaman sebelumnya! ")])):x("",!0),s(e).current.phase=="canceled"?(o(),d("div",ye,[be,t("blockquote",we,f(n.cancelReason),1),t("a",{class:"text-danger fw-bold",href:"#",onClick:c[1]||(c[1]=E((...l)=>s(e).cancelTransaction&&s(e).cancelTransaction(...l),["prevent"]))}," Click untuk kembali ke halaman sebelumnya! ")])):x("",!0),s(e).current.phase=="cooking"||s(e).current.phase=="pending"?(o(),d("div",ke,$e)):x("",!0),s(e).current.phase=="finished"?(o(),d("div",xe,[t("img",{src:ie,alt:"Success",onClick:c[2]||(c[2]=(...l)=>s(e).finishTransaction&&s(e).finishTransaction(...l))})])):x("",!0),s(e).current.phase=="canceled"?(o(),d("div",Ce,[t("img",{src:ce,alt:"Success",onClick:c[3]||(c[3]=(...l)=>s(e).cancelTransaction&&s(e).cancelTransaction(...l))})])):x("",!0)])]))}});const Se={class:"w-100 me-4"},Ve={class:"text-muted"},Ee=y({__name:"OrderItem",props:{item:null},setup(i){const e=i,n=v(k);function a(){n.remove(e.item)}function c(){n.viewedOrder=e.item}return(l,m)=>(o(),d("li",{class:"your-orders list-group-item d-flex justify-content-between align-items-center",onClick:c},[t("div",Se,[t("b",null,f(i.item.name),1),t("div",null,f(i.item.harga)+" x"+f(i.item.quantity),1),t("div",Ve,f(i.item.note),1)]),p(L,{icon:"/delete.svg",semantic:"Delete Order",onClick:E(a,["stop"]),class:"btn-danger"},null,8,["onClick"])]))}});const Me={class:"offcanvas-header border-bottom tss-bg-secondary"},Ge=t("h5",{class:"offcanvas-title",id:"yourOrdersOffcanvasLabel"},"Pesanan Anda",-1),Ie={class:"offcanvas-body p-0"},Ne={class:"px-2 py-1"},Re={class:"position-absolute bottom-0 w-100 mt-2 p-2 border-top tss-bg-secondary"},Pe=t("b",null,"Total: ",-1),qe=y({__name:"OrdersOffcanvas",setup(i){const e=M({isOffcanvasOpen:!0});function n(){e.isOffcanvasOpen=!window.matchMedia("(max-width: 1200px)").matches}Y(()=>{n(),window.addEventListener("resize",n)}),j(()=>{window.removeEventListener("resize",n)});const a=v(k),c=v(A);async function l(){a&&c.run(async()=>{if(a.orders.length==0)throw new Error("Minimal harus ada satu pesanan!");if(await a.createTransaction(),!a.orders)throw new Error(H)})}const m=Intl.NumberFormat(void 0,{currency:"IDR"}),_=G(()=>{const w=a.orders.reduce((b,u)=>b+u.price*u.quantity,0);return m.format(w)});return(w,b)=>(o(),d(C,null,[t("button",{class:"btn btn-primary d-lg-none open-offcanvas-btn",onClick:b[0]||(b[0]=u=>e.isOffcanvasOpen=!0)}," Pesanan Anda "),t("div",{class:K(["offcanvas offcanvas-end",{show:e.isOffcanvasOpen,hiding:!e.isOffcanvasOpen}]),"data-bs-scroll":"true","data-bs-backdrop":"false",tabindex:"-1","aria-labelledby":"yourOrdersOffcanvasLabel"},[t("div",Me,[Ge,t("button",{type:"button",class:"btn-close d-lg-none","data-bs-dismiss":"offcanvas","aria-label":"Close",onClick:b[1]||(b[1]=u=>e.isOffcanvasOpen=!1)})]),t("div",Ie,[t("div",Ne,[p(W,{name:"list-slide-left",tag:"ul",class:"list-group"},{default:T(()=>[(o(!0),d(C,null,V(s(a).orders,u=>(o(),h(Ee,{item:u,key:u.id},null,8,["item"]))),128))]),_:1})]),t("div",Re,[t("p",null,[Pe,D(" "+f(s(_)),1)]),t("div",{class:"w-100 text-center"},[t("button",{class:"btn btn-primary w-75",onClick:l},"Pesan")])])])],2)],64))}});const Ae={class:"modal modal-lg d-block",tabindex:"-1","aria-hidden":"true",role:"dialog"},je={class:"modal-dialog"},De={class:"modal-content"},Ke={class:"modal-header tss-bg-secondary"},Le={class:"modal-title"},ze={class:"modal-body"},Be={class:"d-flex mb-3"},Fe={class:"mx-3"},Je={class:"fs-6 mb-2"},Ue={class:"fs-6 mb-0"},Ye={class:"modal-footer"},We=y({__name:"MenuItemModal",props:{item:null},emits:["close"],setup(i){return(e,n)=>(o(),d("div",Ae,[t("div",je,[t("div",De,[t("div",Ke,[O(e.$slots,"header",{},()=>[t("h5",Le,f(i.item.name),1)]),t("button",{class:"btn-close",onClick:n[0]||(n[0]=a=>e.$emit("close"))})]),t("div",ze,[t("div",Be,[O(e.$slots,"left",{},()=>[p(ae,{src:i.item.img,alt:i.item.name,class:"modal-img"},null,8,["src","alt"])]),O(e.$slots,"right",{},()=>[t("div",Fe,[t("p",Je,f(i.item.description),1),t("p",Ue,[t("i",null,f(i.item.harga),1)]),O(e.$slots,"right-bottom")])])]),O(e.$slots,"bottom")]),t("div",Ye,[O(e.$slots,"footer")])])])]))}});const He={class:"d-flex align-items-center w-100 my-3"},Qe={class:"mx-2"},Xe=["value"],Ze=y({__name:"OrderDetail",setup(i){const e=v(k),n=G(()=>e.viewedOrder);function a(){n.value.quantity==0&&e.remove(e.viewedOrder),e.examine(void 0)}function c(m){n.value.quantity=Math.max(0,Math.min(9,n.value.quantity+m))}function l(m){const _=m.target;n.value.note=_.value}return(m,_)=>(o(),h(We,{item:s(n),onClose:a},{"right-bottom":T(()=>[t("div",He,[t("button",{class:"btn btn-secondary",onClick:_[0]||(_[0]=w=>c(-1))},"-"),t("span",Qe,f(s(n).quantity),1),t("button",{class:"btn btn-secondary",onClick:_[1]||(_[1]=w=>c(1))},"+")])]),bottom:T(()=>[t("textarea",{rows:"3",class:"w-100 p-3 rounded",value:s(n).note,onInput:l,placeholder:"Pesan Tambahan"},null,40,Xe)]),_:1},8,["item"]))}});const P=y({__name:"MenuItemComponent",props:{isGridView:{type:Boolean},item:null},setup(i){const e=i,n=v(k);function a(){n.add(e.item)}return(c,l)=>i.isGridView?(o(),h(te,{key:0,item:i.item,onClick:a},null,8,["item"])):(o(),h(z,{key:1,item:i.item,onClick:a},null,8,["item"]))}}),et={class:"d-flex align-items-center mw-70-lg"},tt={class:"d-flex align-items-center me-4"},st={key:0,class:"menu-grid mw-70-lg"},nt={key:1,class:"mw-70-lg"},at={class:"list-group"},ot=y({__name:"OrderView",setup(i){const e=q(localStorage.getItem("isGridView")!="false"),n=M({search:"",category:""}),a=v(R),c=v(Q),l=v(k),m=G(()=>e.value?{url:"/grid_view.svg",semantic:"Grid View"}:{url:"/list.svg",semantic:"List View"});function _(){e.value=!e.value,localStorage.setItem("isGridView",e.value.toString())}function w(){a.refetch(n)}return X(n,w),(b,u)=>(o(),d(C,null,[p(se,null,{default:T(()=>[s(l).viewedOrder?(o(),h(Ze,{key:0})):x("",!0)]),_:1}),t("div",et,[p(B,{onSearch:u[0]||(u[0]=r=>n.search=r),class:"w-100 me-5"}),t("div",tt,[p(ne,{options:s(c)||[],onSelected:u[1]||(u[1]=r=>n.category=r)},null,8,["options"]),p(L,{icon:s(m).url,semantic:s(m).semantic,class:"btn-secondary ms-2",onClick:_},null,8,["icon","semantic"])])]),e.value?(o(),d("div",st,[(o(!0),d(C,null,V(s(a).data,r=>(o(),h(P,{item:r,isGridView:e.value,key:r.id},null,8,["item","isGridView"]))),128))])):(o(),d("div",nt,[t("ul",at,[(o(!0),d(C,null,V(s(a).data,r=>(o(),h(P,{item:r,isGridView:e.value,key:r.id},null,8,["item","isGridView"]))),128))])])),p(ee,{injectKey:s(R),params:n},null,8,["injectKey","params"]),p(qe)],64))}});const rt=y({__name:"View",setup(i){const e=v(k);return(n,a)=>s(e).current?(o(),h(Te,{key:0})):(o(),h(ot,{key:1}))}}),yt=y({__name:"App",setup(i){return(e,n)=>(o(),h(oe,null,{default:T(()=>[p(F,null,{default:T(()=>[p(rt)]),_:1})]),_:1}))}});export{yt as default};
